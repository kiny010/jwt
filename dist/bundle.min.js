!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r(require("babel-polyfill"),require("crypto"));else if("function"==typeof define&&define.amd)define(["babel-polyfill","crypto"],r);else{var n="object"==typeof exports?r(require("babel-polyfill"),require("crypto")):r(e["babel-polyfill"],e.crypto);for(var t in n)("object"==typeof exports?exports:e)[t]=n[t]}}(this,function(e,r){return function(e){function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var n={};return r.m=e,r.c=n,r.i=function(e){return e},r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=3)}([function(e,r,n){"use strict";function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),i=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=Symbol(),l=Symbol(),c=function(){function e(r){if(t(this,e),this.version="0.0.1",this.algorithmMap={RS256:"RSA-SHA256",RS384:"RSA-SHA384",RS512:"RSA-SHA512"},r!==l)throw"Failed to construct singleton."}return o(e,null,[{key:"instance",get:function(){var r=this;return r[u]||(r[u]=new e(l)),r[u]}}]),o(e,[{key:"encode",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RS512",t=this,o={alg:n,typ:"JWT"},i=t.algorithmMap[n],a=t.escapeBase64url(t.encodeBase64(JSON.stringify(o))),u=t.escapeBase64url(t.encodeBase64(JSON.stringify(e)));return[a,u,t.escapeBase64url(t.encodeBase64(t.sign([a,u].join("."),r,i)))].join(".")}},{key:"decode",value:function(e,r){var n=this;if(!e)throw new Error("No token supplied.");var t=e.split(".");if(3!==t.length)throw new Error("Token is invalid.");var o=t[0],i=t[1],a=n.decodeBase64(n.unescapeBase64url(t[2])),u=JSON.parse(n.decodeBase64(n.unescapeBase64url(o))),l=JSON.parse(n.decodeBase64(n.unescapeBase64url(i))),c=u.alg,f=n.algorithmMap[c];if(!n.verify([o,i].join("."),r,f,a))throw new Error("Signature verification failed.");if(l.nbf&&Date.now()<1e3*l.nbf)throw new Error("Token has not been activated.");if(l.exp&&Date.now()>1e3*l.exp)throw new Error("Token has expired.");return l}},{key:"sign",value:function(e,r,n){return a.default.createSign(n).update(e).sign(r)}},{key:"verify",value:function(e,r,n,t){return a.default.createVerify(n).update(e).verify(r,t)}},{key:"encodeBase64",value:function(e){return new Buffer(e).toString("base64")}},{key:"decodeBase64",value:function(e){return new Buffer(e,"base64")}},{key:"unescapeBase64url",value:function(e){return(e+"===".slice((e.length+3)%4)).replace(/\-/g,"+").replace(/_/g,"/")}},{key:"escapeBase64url",value:function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}}]),e}();r.default=c.instance},function(e,r){e.exports=require("babel-polyfill")},function(e,r){e.exports=require("crypto")},function(e,r,n){n(1),e.exports=n(0)}])});